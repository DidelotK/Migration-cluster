---
# PrÃ©requis pour Cert Manager

- name: "ğŸ” VÃ©rification que le namespace cert-manager n'existe pas"
  kubernetes.core.k8s_info:
    api_version: v1
    kind: Namespace
    name: cert-manager
  register: cert_manager_namespace
  failed_when: false

- name: "ğŸ“ CrÃ©ation du namespace cert-manager"
  kubernetes.core.k8s:
    name: cert-manager
    api_version: v1
    kind: Namespace
    state: present
  when: cert_manager_namespace.resources | length == 0

- name: "ğŸ” VÃ©rification que Helm peut accÃ©der au repository"
  shell: helm repo list | grep jetstack
  register: jetstack_repo_check
  failed_when: false
  changed_when: false

- name: "ğŸ“¦ VÃ©rification du repository Helm jetstack"
  fail:
    msg: "Repository Helm jetstack non trouvÃ©. ExÃ©cutez d'abord le rÃ´le helm."
  when: jetstack_repo_check.rc != 0
