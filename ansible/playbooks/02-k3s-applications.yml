---
# Playbook for K3s applications installation
- name: "🏗️ Essential K3s applications installation"
  hosts: k3s_servers
  become: true
  gather_facts: true

  roles:
  - role: ingress-nginx
    tags: [ ingress-nginx ]

  - role: cert-manager
    tags: [ cert-manager ]

  - role: external-dns
    tags: [ external-dns ]

  - role: applications
    tags: [ applications ]

  post_tasks:
  - name: "✅ K3s applications installed"
    debug:
      msg: |
        🎉 K3s applications installed successfully!

        📦 Components installed:
        - Ingress Nginx {{ ingress_nginx_version | default('latest') }}
        - Cert Manager {{ cert_manager_version | default('latest') }}
        - External DNS {{ external_dns_version | default('latest') }}

        🌐 Applications deployed:
        - Nginx Test: https://nginx.keltio.fr

        🚀 Cluster ready for production!
